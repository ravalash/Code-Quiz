<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="Assets/reset.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <title>Hello, world!</title>
</head>

<body>
    <main class="container">
        <div class="row">
            <div class="col-6" style="margin: auto;">
                <div id="question-section" style="min-height: 30vh;text-align: center;">
                    <h2>Categories</h2>
                </div>
                <div id="instructions-section" style="text-align: center;">
                    <h2>Please select a category</h2>
                </div>
            </div>
        </div>





    </main>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>
    <script>
        var questionSet = "qSet1";
        var selectionCategory = "";
        var selectionNumber = "";
        var selectionName = "";
        var x = 1;
        var quizQuestion = "";
        var quizAnswers = {};
        var quizRightAnswer = "";
        var quizRandom = 0;
        var quizRandomNumbers = new Array;
        var reroll = true;

        categories = {
            javaQuestions: {
                category: "Java",
                qSet1: {
                    question: "Is this a question?",
                    wrongAnswers: ["carrot", "potato", "donkey"],
                    rightAnswer: "yes"
                },
                qSet2: {
                    question: "Is this a cat?",
                    wrongAnswers: ["sticks", "stones", "rocks"],
                    rightAnswer: "no"
                },
                qSet3: {
                    question: "Is this a dog?",
                    wrongAnswers: ["poop", "face", "nose"],
                    rightAnswer: "no"
                }
            },
            disneyQuestions: {
                category: "Disney Characters",
                qSet1: {
                    question: "Is this a mouse?",
                    wrongAnswers: ["puppy", "kitten", "bat"],
                    rightAnswer: "yes"
                },
                qSet2: {
                    question: "Is this a bird?",
                    wrongAnswers: ["heart", "sour", "baby"],
                    rightAnswer: "no"
                }
            },
            musicQuestions: {
                category: "Pop Music",
                qSet1: {
                    question: "Is this a question?",
                    wrongAnswers: ["carrot", "potato", "donkey"],
                    rightAnswer: "yes"
                },
                qSet2: {
                    question: "Is this a cat?",
                    wrongAnswers: ["sticks", "stones", "rocks"],
                    rightAnswer: "no"
                }
            },
            travelQuestions: {
                category: "Travel Destinations",
                qSet1: {
                    question: "Is this a question?",
                    wrongAnswers: ["carrot", "potato", "donkey"],
                    rightAnswer: "yes"
                },
                qSet2: {
                    question: "Is this a cat?",
                    wrongAnswers: ["sticks", "stones", "rocks"],
                    rightAnswer: "no"
                }
            }
        }


        function loadCategories() {
            var categoryArray = Object.keys(categories);
            for (i = 0; i < Object.keys(categories).length; i++) {
                var categoryName = Object.values(categories)[i].category;
                var categoryObject = Object.keys(categories)[i];
                console.log(categoryName);
                var categoryButton = document.createElement("button");
                categoryButton.setAttribute("data-category", categoryName);
                categoryButton.setAttribute("data-object", categoryObject);
                categoryButton.setAttribute("class", "btn btn-primary m-1 category-btn");
                categoryButton.setAttribute("data-number", i);
                categoryButton.setAttribute("style", "width: 100%");
                categoryButton.textContent = categoryName;
                document.getElementById("question-section").appendChild(categoryButton);
            }
        }


        function chooseCategory() {
            event.preventDefault();
            selectionCategory = event.target.getAttribute("data-object");
            selectionNumber = event.target.getAttribute("data-number");
            selectionName = event.target.textContent;
            console.log(selectionCategory + " " + selectionNumber);
            clearQuestionDiv();
            loadQuizQuestions();
            loadInstructions();
            // buildQuestionButtons();

        }

        function loadQuizQuestions() {
            quizQuestionNumber = Object.entries(categories[selectionCategory]).length;
            console.log(quizQuestionNumber);
            quizQuestion = categories[selectionCategory][questionSet].question;
            console.log(quizQuestion);
            quizAnswers = categories[selectionCategory][questionSet].wrongAnswers;
            console.log(quizAnswers);
            quizRightAnswer = categories[selectionCategory][questionSet].rightAnswer;
            console.log(quizRightAnswer);
            quizAnswers.push(quizRightAnswer);
            console.log(quizAnswers);
        }

        function buildQuestionButtons() {
            for (i = 0; i < quizAnswers.length; i++) {
                while (reroll === true) {
                    quizRandom = Math.floor(Math.random() * quizAnswers.length);
                    reroll = false;
                    for (x = -1; x < quizRandomNumbers.length; x++) {
                        if (quizRandomNumbers[x] == quizRandom) {
                            reroll = true;
                        }
                    }
                }
                var questionButton = document.createElement("button");
                questionButton.setAttribute("class", "btn btn-primary m-1 question-btn");
                questionButton.setAttribute("style", "width: 100%");
                questionButton.textContent = quizAnswers[quizRandom];
                quizRandomNumbers.push(quizRandom);
                reroll = true;
                document.getElementById("question-section").appendChild(questionButton);
            }


        }

        function loadInstructions() {
            document.getElementById("question-section").firstElementChild.textContent = "Instructions";
            var instructions = document.createElement("p");
            instructions.textContent = "You will be presented with a series of questions on " + selectionName + ". Each incorrect answer will reduce the alloted time to complete the quiz. Questions are presented until they have all been answered or the clock has expired. Your final score is based on the time remaining on the clock at the end."
            instructions.setAttribute("class", "card mt-5");
            document.getElementById("question-section").appendChild(instructions);
            document.getElementById("question-section").removeEventListener("click", chooseCategory);
            document.getElementById("question-section").setAttribute("id", "start-section");
            document.getElementById("instructions-section").firstElementChild.textContent = "Please select an option";
            var instructionsButton = document.createElement("button");
            instructionsButton.setAttribute("class", "btn btn-success m-1 instructions-btn");
            instructionsButton.setAttribute("style", "width: 50%");
            instructionsButton.textContent = "Start";
            document.getElementById("instructions-section").appendChild(instructionsButton);
            var instructionsButton = document.createElement("button");
            instructionsButton.setAttribute("class", "btn btn-danger m-1 instructions-btn");
            instructionsButton.setAttribute("style", "width: 50%");
            instructionsButton.textContent = "Back";
            document.getElementById("instructions-section").appendChild(instructionsButton);
            document.getElementById("instructions-section").addEventListener("click", chooseInstruction);

        }




        function clearQuestionDiv() {
            while (x) {
                if (document.getElementById("question-section").lastElementChild.nodeName == "BUTTON") {

                    document.getElementById("question-section").removeChild(document.getElementById("question-section").lastElementChild);
                }
                else {
                    return;
                }

            }

        }

        function clearInstructionsDiv() {
            while (x) {
                if (document.getElementById("instructions-section").lastElementChild.nodeName == "BUTTON") {

                    document.getElementById("instructions-section").removeChild(document.getElementById("instructions-section").lastElementChild);
                }
                else {
                    return;
                }

            }

        }

        function clearStartSection() {
            while (x) {
                if (document.getElementById("start-section").lastElementChild.nodeName == "P") {

                    document.getElementById("start-section").removeChild(document.getElementById("start-section").lastElementChild);
                }
                else {
                    return;
                }

            }

        }

        function chooseInstruction() {
            console.log(event);
            console.log(event.target);
            console.log(event.target.textContent);
            if (event.target.textContent == "Back") {
                clearInstructionsDiv();
                clearStartSection();
                document.getElementById("start-section").firstElementChild.textContent = "Categories";
                document.getElementById("instructions-section").firstElementChild.textContent = "Please select a category";
                document.getElementById("start-section").setAttribute("id", "question-section");
                document.getElementById("question-section").addEventListener("click", chooseCategory);
                document.getElementById("instructions-section").removeEventListener("click", chooseInstruction)
                loadCategories();

            }

        }

        loadCategories();
        document.getElementById("question-section").addEventListener("click", chooseCategory);



    </script>
</body>

</html>